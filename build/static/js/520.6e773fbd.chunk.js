"use strict";(self.webpackChunksafeline_IOT=self.webpackChunksafeline_IOT||[]).push([[520],{90520:function(e,a,t){t.r(a),t.d(a,{default:function(){return Z}});var n=t(29439),i=t(78983),r=t(72791),s=t(93001),o=t(52036),d=t(18043),l=t(91933),c=t(99579),u=t(57689),m=t(45013),h=t(3876),f=(t(41268),t(77868)),v=t(18393),p=t(4942),x=t(1413),b=t(24846),j=t(51843),k=t(99412),g=t(31397),S=t(80184),y=function(e){var a=e.closeModal,t=e.saveHandler,s=e.data,o=(0,d.U)().dispatch,u=(0,l.useMutation)(v.Vm).mutate,m=(0,r.useState)([]),h=(0,n.Z)(m,2),f=h[0],y=h[1],E=(0,r.useState)(!1),Z=(0,n.Z)(E,2),C=Z[0],N=Z[1],F=(0,r.useState)({firstname:"",lastname:"",email:"",address:"",phonenumber:"",roleid:0}),I=(0,n.Z)(F,2),O=I[0],w=I[1];(0,r.useEffect)((function(){s&&w((function(){return{firstname:s.firstname,lastname:s.lastname,email:s.email,address:s.address,phonenumber:s.phonenumber,roleid:s.roleid}}))}),[s]);var A=function(e){var a=e.target,t=a.name,n=a.value,i=a.type,r=a.checked,s="roleid"===t?parseInt(n,10):n;w((0,x.Z)((0,x.Z)({},O),{},(0,p.Z)({},t,"checkbox"===i?r:s)))},M=(0,c.X)(),R=M.darkMode;M.setDarkMode;return(0,r.useEffect)((function(){s||u("",{onSuccess:function(e){y(e.data)},onError:function(e){}})}),[R]),(0,S.jsxs)(i.lx,{className:"row mt-2 g-3 needs-validation",noValidate:!0,validated:C,onSubmit:function(e){var n=e.currentTarget;e.preventDefault(),!1===n.checkValidity()&&e.stopPropagation(),N(!0),!0===n.checkValidity()&&(o({type:"SHOW_LOADER"}),t(O),console.log(O),a())},children:[(0,S.jsxs)(i.b7,{md:12,children:[(0,S.jsx)(i.L8,{id:"".concat(R?"heading-dark":""),htmlFor:"validationFacilityName",children:"Role"}),(0,S.jsxs)(i.LX,{name:"roleid","aria-describedby":"validationCustom04Feedback",feedbackInvalid:"Please select a valid facility.",id:"validationFacility",className:" form-select ".concat(R?"select-dark":""),value:O.roleid,onChange:A,disabled:!!s,required:!0,children:[(0,S.jsx)("option",{children:"Select Role"}),null===f||void 0===f?void 0:f.map((function(e){return(0,S.jsx)("option",{value:e.roleid,children:e.name},e.roleid)}))]})]}),(0,S.jsxs)(i.b7,{md:6,children:[(0,S.jsx)(i.L8,{id:"".concat(R?"heading-dark":""),htmlFor:"validationFirstname",children:"First Name"}),(0,S.jsxs)(i.YR,{children:[(0,S.jsx)(i.wV,{}),(0,S.jsx)(i.jO,{type:"text",className:"input-light pt-0 ".concat(R?"input-dark":""),name:"firstname",value:O.firstname,onChange:A,feedbackInvalid:"First Name is required",id:"validationCustom01",required:!0})]})]}),(0,S.jsxs)(i.b7,{md:6,children:[(0,S.jsx)(i.L8,{id:"".concat(R?"heading-dark":""),htmlFor:"validationLastname",children:"Last Name"}),(0,S.jsxs)(i.YR,{className:"has-validation",children:[(0,S.jsx)(i.wV,{}),(0,S.jsx)(i.jO,{type:"text",className:"input-light pt-0 ".concat(R?"input-dark":""),name:"lastname",value:O.lastname,onChange:A,feedbackInvalid:"Last name is required",id:"validationCustom02",required:!0})]})]}),(0,S.jsxs)(i.b7,{md:12,children:[(0,S.jsx)(i.L8,{id:"".concat(R?"heading-dark":""),htmlFor:"validationEmail",children:"Email"}),(0,S.jsxs)(i.YR,{className:"has-validation",children:[(0,S.jsx)(i.wV,{children:(0,S.jsx)(b.Z,{icon:j.p,alt:"Email"})}),(0,S.jsx)(i.jO,{type:"email",className:"input-light pt-0 ".concat(R?"input-dark":""),name:"email",value:O.email,onChange:function(e){var a=e.target,t=a.name,n=a.value,i=a.type,r=a.checked;w((0,x.Z)((0,x.Z)({},O),{},(0,p.Z)({},t,"checkbox"===i?r:n)));var s=e.target.value,o=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(s);N(o)},"aria-describedby":"inputGroupPrependFeedback",feedbackInvalid:" Email is required",id:"validationEmail",required:!0})]})]}),(0,S.jsxs)(i.b7,{md:12,children:[(0,S.jsx)(i.L8,{id:"".concat(R?"heading-dark":""),htmlFor:"validationCustomAddress",children:"Address"}),(0,S.jsxs)(i.YR,{children:[(0,S.jsx)(i.wV,{children:(0,S.jsx)(b.Z,{icon:k.i,alt:"Address"})}),(0,S.jsx)(i.jO,{className:"input-light pt-0 ".concat(R?"input-dark":""),type:"text",name:"address",value:O.address,onChange:A,"aria-describedby":"validationCustom03Feedback",feedbackInvalid:"Address is required.",id:"validationCustom03",required:!0})]})]}),(0,S.jsxs)(i.b7,{md:12,children:[(0,S.jsx)(i.L8,{id:"".concat(R?"heading-dark":""),htmlFor:"validationCustomPhonenumber",children:"Phone Number"}),(0,S.jsxs)(i.YR,{children:[(0,S.jsx)(i.wV,{children:(0,S.jsx)(b.Z,{icon:g.d,alt:"Phonenumber"})}),(0,S.jsx)(i.jO,{className:"input-light pt-0 ".concat(R?"input-dark":""),type:"text",name:"phonenumber",value:O.phonenumber,onChange:A,"aria-describedby":"validationCustom05Feedback",feedbackInvalid:"Phone Number is required",id:"validationCustom05",required:!0})]})]}),(0,S.jsx)(i.b7,{xs:12,children:(0,S.jsx)(i.u5,{color:"primary",className:"float-end",id:"".concat(R?"button-dark":""),type:"submit",children:s?"Edit Staff ":"Add Staff "})})]})},E=[{key:"rolename",label:"Role"},{key:"firstname",label:"Name"},{key:"email",label:"Email"},{key:"phonenumber",label:"Contact Number"},{key:"address",label:"Address"}],Z=function(){var e=(0,d.U)().dispatch,a=function(){return e({type:"SHOW_LOADER"})},t=function(){return e({type:"HIDE_LOADER"})},p=(0,l.useMutation)(v.cn).mutate,x=((0,l.useMutation)(h.QG).mutate,(0,l.useMutation)(v.Xk).mutate),b=((0,l.useMutation)(m.nO).mutate,(0,r.useState)([])),j=(0,n.Z)(b,2),k=j[0],g=j[1],Z=(0,l.useMutation)(v.b_).mutate,C=(0,r.useState)(!1),N=(0,n.Z)(C,2),F=N[0],I=N[1],O=(0,r.useState)(),w=(0,n.Z)(O,2),A=w[0],M=w[1],R=(0,r.useState)(!1),L=(0,n.Z)(R,2),_=L[0],q=L[1],D=(0,c.X)().setShowToast,V=(0,l.useMutation)(v.Vt),U=(0,r.useState)(!0),H=(0,n.Z)(U,2),P=H[0],T=(H[1],(0,u.s0)()),X=function(){I(!1)};function Y(){Z("",{onSuccess:function(e){g(e.data),t()},onError:function(e){}})}function z(e){a(),setTimeout((function(){_?p(e,{onSuccess:function(){t(),D((function(){return{show:!0,title:"Success",content:"User Created Successfully"}})),Y()},onError:function(e){t(),D((function(){var a,t;return{show:!0,title:"Error",content:null===e||void 0===e||null===(a=e.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.error,color:"#FF0000"}}))}}):x({handler:e,editData:A},{onSuccess:function(){t(),D((function(){return{show:!0,title:"Success",content:"User Edited Successfully"}})),Y()},onError:function(e){t(),D((function(){var a,t;return{show:!0,title:"Error",content:null===e||void 0===e||null===(a=e.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.error,color:"#FF0000"}}))}})}),0)}(0,r.useEffect)((function(){Y()}),[]);var G=(0,c.X)(),Q=G.darkMode;G.setDarkMode;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o.$,{title:_?"Add Staff":"Edit Staff",content:_?(0,S.jsx)(y,{closeModal:X,saveHandler:z}):(0,S.jsx)(y,{closeModal:X,saveHandler:z,data:A}),isOpen:F,onClose:X}),(0,S.jsxs)(i.xH,{className:"table_container_light p-4 ".concat(Q?"table_container_dark":""),children:[(0,S.jsxs)(i.rb,{children:[(0,S.jsx)(i.b7,{children:(0,S.jsx)("h3",{className:"pb-2",id:"".concat(Q?"heading-dark":""),children:"Users"})}),(0,S.jsx)(i.b7,{children:(0,S.jsx)(i.u5,{color:"primary",className:"float-end",onClick:function(){q(!0),M(null),I(!0)},children:"Add Users"})})]}),k?(0,S.jsx)(f.Z,{columns:E,OnDeleteItem:function(e){a(),V.mutate(e.userid,{onSuccess:function(){D((function(){return{show:!0,title:"Success",content:"User deleted Successfully"}})),Y(),t()},onError:function(e){"ERR_BAD_REQUEST"===e.code&&(localStorage.removeItem("token"),localStorage.removeItem("OrganizationId"),localStorage.removeItem("facilityId"),localStorage.removeItem("departmentId"),T("/login")),D((function(){return{show:!0,title:"Error",content:e.response.data.error}})),t()}}),t()},data:k,openEditModal:function(e){q(!1),M(e),I(!0)},delUserId:P}):(0,S.jsx)(s.Z,{})]})]})}}}]);
//# sourceMappingURL=520.6e773fbd.chunk.js.map